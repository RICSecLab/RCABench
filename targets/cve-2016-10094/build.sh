#!/bin/bash

. ${TARGET_ROOT}/config.sh

if [ $# -lt 1 ]; then
  echo "Usage: $0 <build dir name>" 1>&2
  exit 1
fi

cd ${TARGET_ROOT}
git clone https://github.com/vadz/libtiff.git $1
cd ${TARGET_ROOT}/$1
git checkout 891b1b9

./configure
for var in "${!TARGET_DEF_@}"; do
  eval "${var#TARGET_DEF_}"="$(printf "%q" "${!var}")"
done
make CFLAGS="${CFLAGS}" CXXFLAGS="${CXXFLAGS}" \
     LDFLAGS="${LDFLAGS}" CC="${CC}" CXX="${CXX}" \
     -j$(nproc)
